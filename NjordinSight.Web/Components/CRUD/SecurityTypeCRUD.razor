@inherits ModelCRUD<SecurityType>

@if (IsLoading)
{
    <LoadingSvg />
}
else
{
    <ModelForm TModelDto="SecurityType">
        <ModelFormLineItem ForMember="@(() => ModelDto.SecurityTypeName)">
            @if (ReadOnly)
            {
                <div class="form-control">
                    @ModelDto.SecurityTypeName
                </div>
            }
            else
            {
                <InputText class="form-control" @bind-Value="ModelDto.SecurityTypeName"
                   disable="@Disabled"
                   DisplayName="@NameFor(x => x.SecurityTypeName)" />
            }
        </ModelFormLineItem>
        <ModelFormLineItem ForMember="@(() => ModelDto.SecurityTypeGroupId)">
            @if (ReadOnly)
            {
                <div class="form-control">
                    @SecurityTypeGroupDisplayName(ModelDto.SecurityTypeGroupId)
                </div>
            }
            else
            {
                <InputSelect class="form-control"
                     DisplayName=@(NameFor(x => x.SecurityTypeGroupId))
                     @bind-Value="ModelDto.SecurityTypeGroupId"
                     disabled="@Disabled">
                @foreach (var lookup in SecurityTypeGroups)
                {
                    <option value=@lookup.Key>@lookup.Display</option>
                }
            </InputSelect>
            }
        </ModelFormLineItem>
        <ModelFormLineItem ForMember="@(() => ModelDto.CanHavePosition)">
            @if (ReadOnly)
            {
                <div class="form-control">
                    @ModelDto.CanHavePosition
                </div>
            }
            else
            {
                <InputCheckbox class="checkbox-themed" @bind-Value="ModelDto.CanHavePosition"
                       disable="@Disabled"
                       DisplayName="@NameFor(x => x.CanHavePosition)" />
            }
        </ModelFormLineItem>
        <ModelFormLineItem ForMember="@(() => ModelDto.CanHaveDerivative)">
            @if (ReadOnly)
            {
                <div class="form-control">
                    @ModelDto.CanHaveDerivative
                </div>
            }
            else
            {
                <InputCheckbox class="checkbox-themed" @bind-Value="ModelDto.CanHaveDerivative"
                       disable="@Disabled"
                       DisplayName="@NameFor(x => x.CanHaveDerivative)" />
            }
        </ModelFormLineItem>
        <ModelFormLineItem ForMember="@(() => ModelDto.HeldInWallet)">
            @if (ReadOnly)
            {
                <div class="form-control">
                    @ModelDto.HeldInWallet
                </div>
            }
            else
            {
                <InputCheckbox class="checkbox-themed" @bind-Value="ModelDto.HeldInWallet"
                       disable="@Disabled"
                       DisplayName="@NameFor(x => x.HeldInWallet)" />
            }
        </ModelFormLineItem>
        <ModelFormLineItem ForMember="@(() => ModelDto.ValuationFactor)">
            @if (ReadOnly)
            {
                <div class="form-control">
                    @ModelDto.ValuationFactor
                </div>
            }
            else
            {
                <InputNumber class="form-control" @bind-Value="ModelDto.ValuationFactor"
                   disable="@Disabled"
                     DisplayName="@NameFor(x => x.ValuationFactor)" />
            }
        </ModelFormLineItem>
    </ModelForm>
}

@code {
    [Parameter, EditorRequired]
    public IEnumerable<LookupModel<int, string>> SecurityTypeGroups { get; set; }

    protected override void OnInitialized()
    {
        IsLoading = ModelDto is null | SecurityTypeGroups is null;
    }
    private string SecurityTypeGroupDisplayName(int? id) =>
        SecurityTypeGroups?.FirstOrDefault(a => a.Key == id)?.Display;
}
